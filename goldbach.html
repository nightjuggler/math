<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Goldbach Partitions</title>
<style>
body {
	background-color: white;
	font-family: verdana;
	font-size: 10pt;
}
table {
	border-collapse: collapse;
}
#gridParent table {
	border: 1px solid #000000;
}
#gridParent td {
	width: 8px;
	height: 8px;
	border: 1px solid #dddddd;
}
#infoParent {
	text-align: center;
}
#layout {
	margin-left: auto;
	margin-right: auto;
}
a {text-decoration: none;}
</style>
<script>
/* globals document, window */
(function() {
'use strict';
const delay = 20;
const firstEven = 6;
const tdArray = [];

var sumCount;
var maxSumCount = 0;
var maxNumber;
var primeArray;
var primeIndex;
var messageText;

function fillGrid()
{
	const p = primeArray[++primeIndex];
	const numPrimes = primeArray.length;
	const prevMaxSums = maxSumCount;

	for (let i = primeIndex; i < numPrimes; ++i)
	{
		const evenNumber = p + primeArray[i];
		if (evenNumber > maxNumber) if (i === primeIndex) return; else break;

		const numSums = ++sumCount[(evenNumber - firstEven) / 2];
		if (numSums > maxSumCount)
			maxSumCount = numSums;
	}

	if (prevMaxSums !== maxSumCount)
	tdArray.forEach((td, i) => {
		const numSums = sumCount[i];
		const hue = (300 * numSums / maxSumCount).toFixed(1);
		td.title = (firstEven + 2 * i) + ' (' + numSums + ')';
		td.style.backgroundColor = 'hsl(' + hue + ',100%,50%)';
	});

	messageText.nodeValue = 'p[' + primeIndex + '] = ' + p + ', maxSumCount = ' + maxSumCount;
	window.setTimeout(fillGrid, delay);
}
function getPrimes(maxNumber)
{
	const arrayLen = maxNumber + 1;
	const notPrime = new Uint8Array(arrayLen);
	const sqrt = Math.floor(Math.sqrt(maxNumber));

	for (let n = 3; n <= sqrt; n += 2)
		if (notPrime[n] === 0)
			for (let i = n * n, step = n * 2; i < arrayLen; i += step)
				notPrime[i] = 1;

	const primes = [2];
	for (let n = 3; n < arrayLen; n += 2)
		if (notPrime[n] === 0)
			primes.push(n);
	return primes;
}
function createTable(numRows, numCols)
{
	const table = document.createElement('table');
	for (let i = 0; i < numRows; ++i)
	{
		const tr = document.createElement('tr');
		for (let j = 0; j < numCols; ++j)
		{
			const td = document.createElement('td');
			tr.appendChild(td);
			tdArray.push(td);
		}
		table.appendChild(tr);
	}
	document.getElementById('gridParent').appendChild(table);
}
function init()
{
	const gridWidth = 60;
	const gridHeight = 60;

	createTable(gridHeight, gridWidth);

	messageText = document.createTextNode('');
	document.getElementById('infoParent').appendChild(messageText);

	sumCount = new Uint16Array(gridWidth * gridHeight);
	maxNumber = firstEven - 2 + 2 * gridWidth * gridHeight;

	document.getElementById('minEven').firstChild.nodeValue = firstEven;
	document.getElementById('maxEven').firstChild.nodeValue = maxNumber;

	primeArray = getPrimes(maxNumber);
	primeIndex = 0;

	window.setTimeout(fillGrid, delay);
}
window.addEventListener('DOMContentLoaded', init);
})();
</script>
</head>
<body>

<table id="layout">
<tr>
<th>The number of
<a href="https://en.wikipedia.org/wiki/Goldbach%27s_conjecture">Goldbach partitions</a>
for every even number from
<span id="minEven">6</span> to
<span id="maxEven">6004</span>
</th>
</tr>
<tr><td id="gridParent"></td></tr>
<tr><td id="infoParent"></td></tr>
</table>

</body>
</html>
